<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wellness Survey Results • Bellbrook Demo</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Raleway:wght@100;300;400;600;700&display=swap" rel="stylesheet" />

  <!-- Existing repo CSS (NOTE: correct relative paths for /wellness-survey/results/) -->
  <link rel="stylesheet" href="../../assets/css/site.css" />
  <link rel="stylesheet" href="../../assets/css/style.css" />
  <link rel="stylesheet" href="../../assets/css/tweaks.css" />

  <!-- Safe additions: header/nav consistency + image robustness -->
  <style>
    :root{
      --nav-bg: rgba(255,255,255,0.92);
      --nav-border: rgba(26,32,44,0.10);
      --shadow: 0 18px 40px rgba(0,0,0,0.12);
      --radius: 18px;
      --brand: #234d69;
      --accent: #2b6cb0;
      --muted: rgba(26,32,44,0.70);
      --card: #ffffff;
      --page: #f3f6fb;
    }
    body{
      font-family: "Raleway", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--page);
      margin: 0;
    }
    img{ max-width:100%; height:auto; display:block; }
    .container{ width:min(1100px, calc(100% - 32px)); margin-inline:auto; }

    /* Header */
    .site-header{
      position: sticky; top:0; z-index:999;
      background: var(--nav-bg);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--nav-border);
    }
    .header-inner{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px; padding:10px 0;
    }
    .brand{
      display:inline-flex; align-items:center; gap:10px;
      text-decoration:none;
    }
    .brand img{ width:42px; height:42px; object-fit:contain; }
    .brand span{
      font-family:"Lilita One", cursive;
      font-size:24px; letter-spacing:.5px;
      color:#1a202c;
    }

    .nav-toggle{
      display:none;
      width:44px; height:44px;
      border-radius:12px;
      border:1px solid var(--nav-border);
      background:#fff;
      cursor:pointer;
    }
    .nav-toggle span{
      display:block; height:2px; background:#1a202c;
      margin:7px 8px; border-radius:2px;
    }

    nav.site-nav ul{
      list-style:none; margin:0; padding:0;
      display:flex; align-items:center; gap:14px;
    }
    nav.site-nav a{
      text-decoration:none;
      font-weight:700;
      padding:10px 10px;
      border-radius:12px;
      display:inline-flex; align-items:center; gap:8px;
      color:#1a202c;
    }
    nav.site-nav a:hover{ background: rgba(43,108,176,0.08); }

    /* Dropdowns */
    .has-dropdown{ position:relative; }
    .dropdown{
      display:none;
      position:absolute;
      top: calc(100% + 10px);
      left:0;
      min-width: 380px;
      background:#fff;
      border:1px solid var(--nav-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:12px;
    }
    .dropdown-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:8px;
    }
    .dropdown-item{
      display:grid; gap:2px;
      padding:12px;
      border-radius:14px;
      text-decoration:none;
    }
    .dropdown-item:hover{ background: rgba(35,77,105,0.08); }
    .dropdown-item strong{ font-weight:800; color: var(--brand); }
    .dropdown-item span{ font-size:13px; opacity:.8; color:#1a202c; }

    @media (min-width: 901px){
      .has-dropdown:hover .dropdown{ display:block; }
    }

    @media (max-width: 900px){
      .nav-toggle{ display:inline-block; }
      nav.site-nav{
        position:fixed;
        inset:64px 12px auto 12px;
        background:#fff;
        border:1px solid var(--nav-border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding:10px;
        display:none;
      }
      nav.site-nav.open{ display:block; }
      nav.site-nav ul{ flex-direction:column; align-items:stretch; gap:6px; }
      nav.site-nav a{ justify-content:space-between; }
      .dropdown{
        position:static;
        min-width:auto;
        border:none;
        box-shadow:none;
        padding:8px 6px 10px;
        display:none;
      }
      .has-dropdown.dropdown-open .dropdown{ display:block; }
    }

    /* Page layout */
    .page-hero{
      background: linear-gradient(180deg, rgba(35,77,105,1) 0%, rgba(35,77,105,0.92) 60%, rgba(243,246,251,1) 100%);
      padding: 46px 0 30px;
    }
    .hero-inner{
      display:flex; align-items:flex-end; justify-content:space-between; gap:18px;
      flex-wrap:wrap;
    }
    .hero-title{
      margin:0;
      font-family:"Lilita One", cursive;
      letter-spacing:.5px;
      color:#fff;
      font-size: clamp(30px, 4vw, 48px);
    }
    .hero-sub{
      margin:8px 0 0;
      color: rgba(255,255,255,0.82);
      font-weight: 300;
      max-width: 70ch;
    }
    .pill{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px;
      border-radius:999px;
      background: rgba(255,255,255,0.14);
      border: 1px solid rgba(255,255,255,0.22);
      color:#fff;
      font-weight:700;
      white-space:nowrap;
    }

    .content{
      padding: 20px 0 54px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 900px){
      .grid{ grid-template-columns:1fr; }
    }

    .card{
      background: var(--card);
      border: 1px solid rgba(26,32,44,0.08);
      border-radius: 22px;
      box-shadow: 0 10px 24px rgba(0,0,0,0.06);
      overflow:hidden;
    }
    .card h2{
      margin:0;
      padding:16px 16px 6px;
      font-family:"Lilita One", cursive;
      color:#1a202c;
      font-size: 26px;
      letter-spacing:.3px;
    }
    .card p{
      margin:0;
      padding:0 16px 16px;
      color: var(--muted);
      line-height: 1.5;
    }
    .card .body{ padding: 0 16px 16px; }
    .results-list{
      display:grid;
      gap:12px;
      margin:0;
      padding: 0 16px 18px;
      list-style:none;
    }
    .result-item{
      border: 1px solid rgba(26,32,44,0.10);
      border-radius: 16px;
      padding: 12px;
      display:grid;
      gap:6px;
      background: rgba(243,246,251,0.60);
    }
    .result-item strong{ color:#1a202c; }
    .result-item small{ color: var(--muted); }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      padding: 0 16px 18px;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:12px 14px;
      border-radius:999px;
      text-decoration:none;
      font-weight:800;
      border:1px solid rgba(26,32,44,0.12);
      background:#fff;
      color:#1a202c;
      cursor:pointer;
    }
    .btn.primary{
      background: var(--accent);
      color:#fff;
      border-color: rgba(0,0,0,0);
    }
    .btn:hover{ filter: brightness(0.98); }

    .note{
      padding: 14px 16px 18px;
      border-top: 1px solid rgba(26,32,44,0.08);
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
      background: rgba(243,246,251,0.45);
    }

    /* Footer */
    .site-footer{
      background:#0f2230;
      color: rgba(255,255,255,0.85);
      padding:18px 0;
      margin-top: 20px;
    }
    .footer-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
    }
    .footer-inner a{ color: rgba(255,255,255,0.85); text-decoration:none; }
    .footer-inner a:hover{ color:#fff; text-decoration:underline; }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="#" data-home-link>
        <img src="../../assets/img/logo.svg" alt="Bellbrook" onerror="this.style.display='none';" />
        <span>Bellbrook</span>
      </a>

      <button class="nav-toggle" type="button" aria-label="Open menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>

      <nav class="site-nav" aria-label="Main navigation">
        <ul id="mainNav"></ul>
      </nav>
    </div>
  </header>

  <!-- PAGE HERO -->
  <section class="page-hero">
    <div class="container hero-inner">
      <div>
        <h1 class="hero-title">Wellness Survey Results</h1>
        <p class="hero-sub">
          Here’s a quick summary based on your answers. If nothing shows up, it usually means the survey hasn’t been submitted on this device yet.
        </p>
      </div>
      <div class="pill" id="resultsPill">Results: <span id="resultsStatus">Loading…</span></div>
    </div>
  </section>

  <!-- CONTENT -->
  <main class="content">
    <div class="container grid">

      <!-- Results Card -->
      <section class="card" aria-labelledby="resultsHeading">
        <h2 id="resultsHeading">Your Summary</h2>
        <p id="resultsIntro">We’ll display whatever we can find from the survey submission.</p>

        <ul class="results-list" id="resultsList">
          <!-- populated by JS -->
        </ul>

        <div class="actions">
          <a class="btn primary" href="#" data-link="wellness-survey/index.html">Retake Survey</a>
          <a class="btn" href="#" data-link="resources/index.html">Explore Resources</a>
          <button class="btn" type="button" id="clearBtn">Clear Saved Results</button>
        </div>

        <div class="note">
          <strong>Note:</strong> This is a demo. Results are shown from your browser storage (if present) or URL parameters.
        </div>
      </section>

      <!-- Next Steps Card -->
      <aside class="card" aria-labelledby="nextHeading">
        <h2 id="nextHeading">Next Steps</h2>
        <p>
          Use the dropdown menu in the header to navigate the full site. You can also jump to:
        </p>

        <div class="body">
          <div style="display:grid; gap:10px;">
            <a class="btn" href="#" data-link="videos/index.html">Videos</a>
            <a class="btn" href="#" data-link="stories/index.html">Stories</a>
            <a class="btn" href="#" data-link="contact/index.html">Contact</a>
            <a class="btn" href="#" data-link="faqs/index.html">FAQs</a>
          </div>
        </div>

        <div class="note">
          If this page “wouldn’t load” before, it was likely due to broken header markup or bad script paths. This file fixes the paths for this folder depth.
        </div>
      </aside>

    </div>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container footer-inner">
      <span>© <span id="year"></span> Bellbrook Demo</span>
      <div style="display:flex; gap:12px; flex-wrap:wrap;">
        <a href="#" data-home-link>Home</a>
        <a href="#" data-link="resources/index.html">Resources</a>
        <a href="#" data-link="videos/index.html">Videos</a>
        <a href="#" data-link="contact/index.html">Contact</a>
      </div>
    </div>
  </footer>

  <!-- Existing repo JS (correct path from this folder) -->
  <script src="../../assets/js/site-nav.js" defer></script>

  <!-- Nav builder + Results logic (works even if site-nav.js is empty/broken) -->
  <script>
    // GitHub Pages base path helper:
    // If site is hosted at /bellbrook/, base becomes "/bellbrook/"
    // If hosted at root domain, base becomes "/"
    function getBasePath() {
      const parts = window.location.pathname.split("/").filter(Boolean);
      if (parts.length > 0) return "/" + parts[0] + "/";
      return "/";
    }

    const BASE = getBasePath();

    function hrefTo(rel) {
      rel = rel.replace(/^\/+/, "");
      return BASE + rel;
    }

    // Fill links
    document.querySelectorAll("[data-home-link]").forEach(a => a.setAttribute("href", hrefTo("index.html")));
    document.querySelectorAll("[data-link]").forEach(a => a.setAttribute("href", hrefTo(a.getAttribute("data-link"))));
    document.getElementById("year").textContent = new Date().getFullYear();

    // NAV MAP (from your repo tree)
    const NAV = [
      { label: "Home", href: "index.html" },
      {
        label: "About",
        items: [
          { label: "About", href: "about/index.html" },
          { label: "About Us", href: "about-us/index.html" },
          { label: "Stories", href: "stories/index.html" },
          { label: "Recruiting", href: "recruiting/index.html" }
        ]
      },
      {
        label: "Resources",
        items: [
          { label: "All Resources", href: "resources/index.html", sub: "Browse everything" },
          { label: "Puppy & Kitten Tips", href: "resources/puppy-kitten-tips/index.html", sub: "First-year roadmap" },
          { label: "Dental Health", href: "resources/dental-health/index.html", sub: "Cleanings & at-home care" },
          { label: "Giving Medications", href: "resources/giving-medications/index.html", sub: "Easy techniques" },
          { label: "Educational Videos", href: "resources/educational-videos/index.html", sub: "Learn quickly" }
        ]
      },
      {
        label: "Wellness Survey",
        items: [
          { label: "Start Survey", href: "wellness-survey/index.html", sub: "Begin the form" },
          { label: "Results", href: "wellness-survey/results/index.html", sub: "View outcomes" }
        ]
      },
      { label: "Videos", href: "videos/index.html" },
      {
        label: "Info",
        items: [
          { label: "FAQs", href: "faqs/index.html" },
          { label: "Privacy Policy", href: "privacy-policy/index.html" },
          { label: "Contact", href: "contact/index.html" }
        ]
      }
    ];

    const navEl = document.getElementById("mainNav");

    function navLink(label, href) {
      const a = document.createElement("a");
      a.textContent = label;
      a.href = hrefTo(href);
      return a;
    }

    function buildNav() {
      if (!navEl) return;
      navEl.innerHTML = "";

      NAV.forEach(node => {
        const li = document.createElement("li");

        if (!node.items) {
          li.appendChild(navLink(node.label, node.href));
        } else {
          li.className = "has-dropdown";
          const trigger = document.createElement("a");
          trigger.href = "#";
          trigger.className = "dropdown-trigger";
          trigger.textContent = node.label;

          const dd = document.createElement("div");
          dd.className = "dropdown";

          const grid = document.createElement("div");
          grid.className = "dropdown-grid";

          node.items.forEach(item => {
            const itemA = document.createElement("a");
            itemA.className = "dropdown-item";
            itemA.href = hrefTo(item.href);

            const strong = document.createElement("strong");
            strong.textContent = item.label;

            itemA.appendChild(strong);

            const sub = document.createElement("span");
            sub.textContent = item.sub || "";
            itemA.appendChild(sub);

            grid.appendChild(itemA);
          });

          dd.appendChild(grid);

          li.appendChild(trigger);
          li.appendChild(dd);
        }

        navEl.appendChild(li);
      });

      // Mobile dropdown click expand
      document.querySelectorAll(".dropdown-trigger").forEach((trigger) => {
        trigger.addEventListener("click", (e) => {
          if (window.matchMedia("(max-width: 900px)").matches) {
            e.preventDefault();
            const parent = trigger.closest(".has-dropdown");
            parent && parent.classList.toggle("dropdown-open");
          }
        });
      });
    }

    // Mobile menu toggle
    const btn = document.querySelector(".nav-toggle");
    const nav = document.querySelector(".site-nav");
    btn && btn.addEventListener("click", () => {
      const isOpen = nav.classList.toggle("open");
      btn.setAttribute("aria-expanded", String(isOpen));
    });

    buildNav();

    // ---------------------------
    // Results logic (non-breaking)
    // ---------------------------
    const resultsStatus = document.getElementById("resultsStatus");
    const resultsList = document.getElementById("resultsList");
    const resultsIntro = document.getElementById("resultsIntro");
    const clearBtn = document.getElementById("clearBtn");

    function addResult(title, value, note) {
      const li = document.createElement("li");
      li.className = "result-item";

      const strong = document.createElement("strong");
      strong.textContent = title;

      const div = document.createElement("div");
      div.textContent = value;

      li.appendChild(strong);
      li.appendChild(div);

      if (note) {
        const small = document.createElement("small");
        small.textContent = note;
        li.appendChild(small);
      }

      resultsList.appendChild(li);
    }

    function parseQueryParams() {
      const params = new URLSearchParams(window.location.search);
      const obj = {};
      for (const [k, v] of params.entries()) obj[k] = v;
      return obj;
    }

    function loadResults() {
      resultsList.innerHTML = "";

      // Option A: localStorage (preferred)
      let stored = null;
      try {
        stored = localStorage.getItem("wellnessSurveyResults") || localStorage.getItem("wellnessSurvey");
      } catch (_) {}

      // Option B: URL params
      const qp = parseQueryParams();

      let data = null;

      if (stored) {
        try {
          data = JSON.parse(stored);
        } catch (_) {
          // if it was plain text
          data = { summary: stored };
        }
      } else if (Object.keys(qp).length) {
        data = qp;
      }

      if (!data) {
        resultsStatus.textContent = "No saved results";
        resultsIntro.textContent = "No results were found on this device. Try taking the survey first, then return here.";
        addResult("What to do next", "Take the survey, then come back to results.", "Tip: Use the header dropdown to navigate.");
        return;
      }

      resultsStatus.textContent = "Ready";
      resultsIntro.textContent = "Here’s what we found from your last submission:";

      // Render common keys nicely, but also handle arbitrary JSON
      const preferredOrder = ["petName", "pet_type", "petType", "age", "concerns", "score", "risk", "recommendation", "summary"];

      const seen = new Set();
      for (const key of preferredOrder) {
        if (key in data) {
          addResult(key.replace(/([A-Z])/g, " $1").replace(/^./, c => c.toUpperCase()), String(data[key]));
          seen.add(key);
        }
      }

      for (const key of Object.keys(data)) {
        if (seen.has(key)) continue;
        addResult(key.replace(/([A-Z])/g, " $1").replace(/^./, c => c.toUpperCase()), String(data[key]));
      }
    }

    clearBtn.addEventListener("click", () => {
      try {
        localStorage.removeItem("wellnessSurveyResults");
        localStorage.removeItem("wellnessSurvey");
      } catch (_) {}
      loadResults();
    });

    loadResults();
  </script>

</body>
</html>
